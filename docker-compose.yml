version: '3.8'

services:
  ytandchill:
    build: .
    image: ytandchill:latest
    container_name: ytandchill
    networks:
      - bridge
    ports:
      - "${PORT:-4099}:4099"
      - "4098:4098"  # Dev server port
    environment:
      - PORT=4099
      - PUID=99   # Change to your UID (run 'id -u')
      - PGID=100  # Change to your GID (run 'id -g')
    volumes:
      # IMPORTANT: Use absolute paths only! Tilde (~) does NOT expand in docker-compose.
      # Wrong:   ~/downloads:/app/downloads
      # Correct: /home/yourusername/downloads:/app/downloads
      #
      # Database and config
      - /mnt/user/appdata/ytandchill/data:/app/data
      # Downloads (videos and thumbnails)
      - /mnt/user/data/media/youtube/ytandchill:/app/downloads
      # Logs
      - /mnt/user/appdata/ytandchill/logs:/app/logs
      # NOTE: cookies.txt goes inside your data folder (e.g., /mnt/user/appdata/ytandchill/data/cookies.txt)
      # Firefox profile for automatic cookie extraction (optional)
      # Linux: /home/USERNAME/.mozilla/firefox | macOS: /Users/USERNAME/Library/Application Support/Firefox/Profiles
      # - /home/YOUR_USERNAME/.mozilla/firefox:/firefox_profile:ro
    restart: unless-stopped
    labels:
      # Unraid WebUI integration
      - "net.unraid.docker.managed=dockerman"
      - "net.unraid.docker.webui=http://[IP]:[PORT:4099]/"
      - "net.unraid.docker.icon=https://raw.githubusercontent.com/walkxcode/dashboard-icons/main/png/youtube.png"

networks:
  bridge:
    driver: bridge
